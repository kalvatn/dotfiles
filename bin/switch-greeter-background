#!/bin/bash

set -e
source "$HOME/.functions"

if [ -z "$1" ]; then
  image_file="$(random_image)"
else
  image_file="$1"
fi

#copy wallpaper into system hierarchy
sudo cp "$image_file" /usr/share/backgrounds/background.jpg

#configure lightdm
sudo xhost +SI:localuser:lightdm

sudo su lightdm -s /bin/bash <<HERE
gsettings set com.canonical.unity-greeter draw-user-backgrounds 'false' #eliminates display of other users wallpaper at login
gsettings set com.canonical.unity-greeter background '/usr/share/backgrounds/background.jpg' #set login wallpaper
gsettings set com.canonical.unity-greeter draw-grid 'false' #removes dots on background
gsettings set com.canonical.unity-greeter background-color '#000000' #eliminates purple screen before background loads
exit
HERE
